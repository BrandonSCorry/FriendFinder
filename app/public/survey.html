<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>'Friend' Finder - Survey</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous">
  </script>

  <style>
    #nameFriendMatch {
      text-align: center;
    }

    #imgFriendMatch {
      width: 100%;
    }

    h1,
    h2,
    h3,
    h5,
    h6{
      text-align: center;
    }

    h3 {
      padding: 0.875rem;
    }

    select {
      margin-bottom: 1rem;
    }

    header {
      text-align:center;
    }

    label {
      font-size: 1.5rem;
      color: black!important;
    }

    .dropdown-content li > span {

      font-size: 1rem;
    }

    .select-wrapper input.select-dropdown {
      text-align: center
    }

    button {
      width:100%;
    }

    .btn{
      background-color: dodgerblue;
      color: white;
    }
    .btn:visited{
      background-color: dodgerblue;
    }
    .btn:hover {
      background-color: steelblue;
    }
    .btn:active{
      background-color: cornflowerblue;
    }
    .btn:focus{
      background-color: cornflowerblue;
    }
    ul.dropdown-content.select-dropdown li span {
      color: dodgerblue;
      text-align: center!important;
    }
    .select-wrapper input.select-dropdown:focus , input:focus{
      color: dodgerblue;
      border-bottom: 1px solid dodgerblue!important;
    }

    .modal-close {
      position: absolute;
      top: 0.25em;
      right: 0.25em;
      font-size: 2em;
    }


  </style>

  <script>
    $(document).ready(function(){
      $('select').formSelect();
      $('.modal').modal();
    });

  </script>

</head>

<body>

<div class="container">
  <header id="survey-header">

    <div class="row">
      <div class="col s12">

        <h1>Personality Survey</h1>
        <div class="divider"></div>

      </div>

    </div>


    <h3><u>About You</u></h3>

    <div class="row">
      <div class="input-field col s6">
        <i class="material-icons prefix blue-text">account_box</i>
        <label for="name">Name (Required)</label>
        <input type="text" id="name" class="nameInput personalInput" required>
      </div>

      <div class="input-field col s6">
        <i class="material-icons prefix blue-text">add_a_photo</i>

        <label for="photo">Link to your photo (Required)</label>
        <input type="text" id="photo" class="photoInput personalInput" required>

      </div>

    </div>

  </header>

  <section id="survey-inputs">

    <h5>Please indicate a value on a scale of 1-5 (1 for strongly disagree - 5 for strongly agree) for each statement.</h5>
    <h6>You must fill out the entire survey to submit it.</h6>

    <div class="row">

      <div class="input-field col s4 offset-s4 center">

        <h4><label for="q1">#1: I enjoy having pets.</label></h4>

        <select required id="q1">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>

    </div>

    <div class="row">

      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q2">#2: I enjoy being around children.</label></h4>

        <select required id="q2">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q3">#3: I like being outside.</label></h4>

        <select required id="q3">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q4">#4: I avoid confrontation.</label></h4>

        <select required id="q4">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>


    <div class="row">
      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q5">#5: I respond well to constructive criticism</label></h4>

        <select  id="q5" required>
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q6">#6: I'm a religious person.</label></h4>

        <select required id="q6">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>



    <div class="row">
      <div class="input-field col s4 offset-s4 center">
        <h4><label for="q7">#7: Politics are important to me.</label></h4>

        <select required id="q7">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>



    <div class="row">
      <div class="input-field col s4 offset-s4 center">

        <h4><label for="q8">#8: Vaccinations are good.</label></h4>

        <select required id="q8">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>

      </div>
    </div>


    <div class="row">
      <div class="input-field col s4 offset-s4 center">

        <h4><label for="q9">#9: I believe that truth = truth.</label></h4>

        <select required id="q9">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>

      </div>
    </div>

    <div class="row">
      <div class="input-field col s4 offset-s4 center">

        <h4><label for="q10">#10: Star Trek is better than Star Wars.</label></h4>

        <select required id="q10">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
    </div>
    <!-- Submit Button -->

    <button id="submit" data-target="modal1" class="btn modal-trigger waves-effect waves-blue" type="submit" name="action">
      Find Friends
      <i class="material-icons right">chevron_right</i>
    </button>

  </section>

  <div class="divider"></div>
  <footer class="footer right">
    <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/BrandonSCorry/FriendFinder">GitHub Repo</a></p>
  </footer>

</div>

<!-- Modal -->

<div id="modal1" class="modal">
  <div class="modal-content">
    <a href="#" class="modal-close btn-flat">&times;</a>

    <h4 class="center-align">Best Match</h4>

    <h3 id="nameFriendMatch"></h3>
    <img id="imgFriendMatch" src="" alt="">
  </div>
  <div class="modal-footer">
  </div>
</div>

<script type="text/javascript">



  $("#submit").on("click", function(event) {
    event.preventDefault();

    var errorModal = function() {
      $('#modal1').html("<a href='#' class='modal-close btn-flat'>&times;</a><h3 class='center' style='padding:2em;'>Please fill out all survey questions before submitting.</h3>");
    };

    var matchModal = function () {

      var inputScoreArr = [];
      $.each($("select option:selected"), function () {
        var optionValue = $(this).val();
        console.log(optionValue);
        inputScoreArr.push($(this).val());
        console.log(inputScoreArr);
      });



        var userData = {
        name: $("#name").val(),
        photo: $("#photo").val(),
        scores: inputScoreArr
      };

      // AJAX post the data to the friends API.
      $.post("/api/friends", userData, function(data) {

        // Grab the result from the AJAX post so that the best match's name and photo are displayed.
        $("#nameFriendMatch").text(data.name);
        $("#imgFriendMatch").attr("src", data.photo);

        // Show the modal with the best match
        $('#modal1').show();
        $('.modal-overlay').show();

      });
    }

    function validate() {
      var isValid = true;
      $(".personalInput").each(function() {
        if ($(this).val() === "") {
          isValid = false;
        }
      });

      $("select option:selected").each(function() {
        console.log($(this));

        if ($(this).val() === "") {
          isValid = false;
        }
      });
      return isValid;
    }

    if (validate()) {
      matchModal();

    } else {
      errorModal();
    }
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

</body>

</html>
